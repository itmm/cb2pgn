<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Convert ChessBase files to PGN</title>
<link rel="stylesheet" type="text/css" href="slides/slides.css"></head>
<body>
<h1>Convert ChessBase files to PGN</h1>
<div class="slides">
<div class="page">
<div class="slide"><div class="slide-nr">1</div><div class="headers">
<h1>Convert ChessBase files to PGN</h1>
</div></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">2</div>
<code>
<span class="macro">@Def(<span class="name">file: cb2pgn.cpp</span>)</span><br/>
<span class="in1"></span><span class="macro">@put(<span class="name">includes</span>)</span>;<br/>
<span class="in1"></span><span class="macro">@put(<span class="name">globals</span>)</span>;<br/>
<span class="in1"></span><span class="type">int</span> <span class="fn">main</span>(<span class="type">int</span> <span class="var">argc</span>, <span class="type">char</span> *<span class="var">argv</span>[]) {<br/>
<span class="in2"></span><span class="macro">@put(<span class="name">main</span>)</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@End(<span class="name">file: cb2pgn.cpp</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">3</div>
<code>
<span class="macro">@def(<span class="name">includes</span>)</span><br/>
<span class="in1"></span><span class="keyword">#include</span> &lt;<span class="var">cstdlib</span>&gt;<br/>
<span class="in1"></span><span class="keyword">#include</span> &lt;<span class="var">iostream</span>&gt;<br/>
<span class="macro">@end(<span class="name">includes</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">4</div>
<code>
<span class="macro">@def(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">fail</span>(<span class="type">const</span> <span class="type">std</span>::<span class="type">string</span> &amp;<span class="var">msg</span>) {<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cerr</span> &lt;&lt; <span class="var">msg</span> &lt;&lt; <span class="str">"\n"</span>;<br/>
<span class="in2"></span><span class="type">std</span>::<span class="fn">exit</span>(<span class="var">EXIT_FAILURE</span>);<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">5</div>
<code>
<span class="macro">@def(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">argc</span> != <span class="num">2</span>) {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="str">"call with cb base name"</span>);<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">6</div>
<code>
<span class="macro">@add(<span class="name">includes</span>)</span><br/>
<span class="in1"></span><span class="keyword">#include</span> &lt;<span class="var">fstream</span>&gt;<br/>
<span class="macro">@end(<span class="name">includes</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">7</div>
<code>
<span class="macro">@add(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">string</span> <span class="var">path</span> { <span class="var">argv</span>[<span class="num">1</span>] };<br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">ifstream</span> <span class="var">main_file</span> {<br/>
<span class="in2"></span>(<span class="var">path</span> + <span class="str">".cbh"</span>).<span class="fn">c_str</span>(),<br/>
<span class="in2"></span><span class="type">std</span>::<span class="type">ifstream</span>::<span class="var">binary</span><br/>
<span class="in1"></span>};<br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">ifstream</span> <span class="var">game_file</span> {<br/>
<span class="in2"></span>(<span class="var">path</span> + <span class="str">".cbg"</span>).<span class="fn">c_str</span>(),<br/>
<span class="in2"></span><span class="type">std</span>::<span class="type">ifstream</span>::<span class="var">binary</span><br/>
<span class="in1"></span>};<br/>
<span class="in1"></span><span class="type">char</span> <span class="var">main_entry</span>[<span class="num">46</span>];<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">8</div>
<code>
<span class="macro">@add(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="keyword">if</span> (! <span class="var">main_file</span>.<span class="fn">read</span>(<br/>
<span class="in2"></span><span class="var">main_entry</span>, <span class="fn">sizeof</span>(<span class="var">main_entry</span>)<br/>
<span class="in1"></span>)) {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="str">"can't read header of "</span><br/>
<span class="in3"></span><span class="str">"cbh file"</span><br/>
<span class="in2"></span>);<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">9</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">int</span> <span class="fn">get_int</span>(<br/>
<span class="in2"></span><span class="type">const</span> <span class="type">char</span> *<span class="var">c</span>, <span class="type">int</span> <span class="var">len</span> = <span class="num">4</span><br/>
<span class="in1"></span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">result</span> { <span class="num">0</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">int</span> <span class="var">i</span> { <span class="num">0</span> }; <span class="var">i</span> &lt; <span class="var">len</span>; ++<span class="var">i</span>) {<br/>
<span class="in3"></span><span class="var">result</span> = (<span class="var">result</span> &lt;&lt; <span class="num">8</span>) |<br/>
<span class="in4"></span>(<span class="var">c</span>[<span class="var">i</span>] &amp; <span class="num">0xff</span>);<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">result</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">10</div>
<code>
<span class="macro">@add(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="type">int</span> <span class="var">count</span> { <span class="fn">get_int</span>(<span class="var">main_entry</span> + <span class="num">6</span>) };<br/>
<span class="in1"></span>--<span class="var">count</span>;<br/>
<span class="in1"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"number of games: "</span> &lt;&lt;<br/>
<span class="in2"></span><span class="var">count</span> &lt;&lt; <span class="str">"\n"</span>;<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">11</div>
<code>
<span class="macro">@add(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="keyword">for</span> (; <span class="var">main_file</span>.<span class="fn">read</span>(<br/>
<span class="in2"></span><span class="var">main_entry</span>, <span class="fn">sizeof</span>(<span class="var">main_entry</span>)<br/>
<span class="in1"></span>); --<span class="var">count</span>) {<br/>
<span class="in2"></span><span class="macro">@put(<span class="name">process game</span>)</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">12</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">string</span> <span class="fn">to_str</span>(<span class="type">int</span> <span class="var">value</span>, <span class="type">unsigned</span> <span class="var">pad</span> = <span class="num">0</span>) {<br/>
<span class="in2"></span><span class="type">std</span>::<span class="type">string</span> <span class="var">result</span> { <span class="type">std</span>::<span class="fn">to_string</span>(<span class="var">value</span>) };<br/>
<span class="in2"></span><span class="keyword">while</span> (<span class="var">result</span>.<span class="fn">size</span>() &lt; <span class="var">pad</span>) {<br/>
<span class="in3"></span><span class="var">result</span> = <span class="str">"0"</span> + <span class="var">result</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">result</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">13</div>
<code>
<span class="macro">@add(<span class="name">main</span>)</span><br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">count</span> == <span class="num">0</span>) {<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"DONE\n"</span>;<br/>
<span class="in1"></span>} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="var">count</span> &gt; <span class="num">0</span>) {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="str">"missing"</span> + <span class="fn">to_str</span>(<span class="var">count</span>) + <span class="str">" games"</span>);<br/>
<span class="in1"></span>} <span class="keyword">else</span> {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="fn">to_str</span>(-<span class="var">count</span>) + <span class="str">" surplus games"</span>);<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">main</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">14</div>
<code>
<span class="macro">@def(<span class="name">process game</span>)</span> {<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">date</span> { <span class="fn">get_int</span>(<br/>
<span class="in2"></span><span class="var">main_entry</span> + <span class="num">24</span>, <span class="num">3</span><br/>
<span class="in1"></span>) };<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">day</span> { <span class="var">date</span> &amp; <span class="num">0x1f</span> };<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">month</span> { (<span class="var">date</span> &amp; <span class="num">0x1e0</span>) &gt;&gt; <span class="num">5</span> };<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">year</span> { <span class="var">date</span> &gt;&gt; <span class="num">9</span> };<br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">year</span> || <span class="var">month</span> || <span class="var">day</span>) {<br/>
<span class="in2"></span><span class="macro">@put(<span class="name">print date</span>)</span>;<br/>
<span class="in1"></span>}<br/>
} <span class="macro">@end(<span class="name">process game</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">15</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">string</span> <span class="fn">to_str_not_null</span>(<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">value</span>,<br/>
<span class="in2"></span><span class="type">const</span> <span class="type">std</span>::<span class="type">string</span> &amp;<span class="var">placeholder</span><br/>
<span class="in1"></span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">value</span> ?  <span class="fn">to_str</span>(<span class="var">value</span>,<br/>
<span class="in3"></span><span class="var">placeholder</span>.<span class="fn">size</span>()<br/>
<span class="in2"></span>) : <span class="var">placeholder</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">16</div>
<code>
<span class="macro">@def(<span class="name">print date</span>)</span><br/>
<span class="in1"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"[Date \""</span> &lt;&lt; <br/>
<span class="in2"></span><span class="fn">to_str_not_null</span>(<span class="var">year</span>, <span class="str">"????"</span>) &lt;&lt;<br/>
<span class="in2"></span><span class="str">"."</span> &lt;&lt;<br/>
<span class="in2"></span><span class="fn">to_str_not_null</span>(<span class="var">month</span>, <span class="str">"??"</span>) &lt;&lt;<br/>
<span class="in2"></span><span class="str">"."</span> &lt;&lt;<br/>
<span class="in2"></span><span class="fn">to_str_not_null</span>(<span class="var">day</span>, <span class="str">"??"</span>) &lt;&lt;<br/>
<span class="in2"></span><span class="str">"\"]\n"</span>;<br/>
<span class="macro">@end(<span class="name">print date</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">17</div>
<code>
<span class="macro">@add(<span class="name">process game</span>)</span> {<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">round</span> { <span class="var">main_entry</span>[<span class="num">29</span>] };<br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">round</span>) {<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"[Round \""</span> &lt;&lt;<br/>
<span class="in3"></span><span class="fn">to_str</span>(<span class="var">round</span>) &lt;&lt; <span class="str">"\"]\n"</span>;<br/>
<span class="in1"></span>}<br/>
} <span class="macro">@end(<span class="name">process game</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">18</div>
<code>
<span class="macro">@add(<span class="name">process game</span>)</span><br/>
<span class="in1"></span><span class="type">std</span>::<span class="type">string</span> <span class="var">result</span>;<br/>
<span class="in1"></span><span class="keyword">switch</span> (<span class="var">main_entry</span>[<span class="num">27</span>]) {<br/>
<span class="in2"></span><span class="keyword">case</span> <span class="num">0</span>:<br/>
<span class="in3"></span><span class="var">result</span> = <span class="str">"0-1"</span>; <span class="keyword">break</span>;<br/>
<span class="in2"></span><span class="keyword">case</span> <span class="num">1</span>:<br/>
<span class="in3"></span><span class="var">result</span> = <span class="str">"1/2-1/2"</span>; <span class="keyword">break</span>;<br/>
<span class="in2"></span><span class="keyword">case</span> <span class="num">2</span>:<br/>
<span class="in3"></span><span class="var">result</span> = <span class="str">"1-0"</span>; <span class="keyword">break</span>;<br/>
<span class="in2"></span><span class="keyword">default</span>:<br/>
<span class="in3"></span><span class="var">result</span> = <span class="str">"*"</span>; <span class="keyword">break</span>;<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"[Result \""</span> &lt;&lt;<br/>
<span class="in2"></span><span class="var">result</span> &lt;&lt; <span class="str">"\"]\n"</span>;<br/>
<span class="macro">@end(<span class="name">process game</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">19</div>
<code>
<span class="macro">@add(<span class="name">process game</span>)</span><br/>
<span class="in1"></span><span class="macro">@put(<span class="name">process moves</span>)</span>;<br/>
<span class="in1"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="var">result</span> &lt;&lt; <span class="str">"\n\n"</span>;<br/>
<span class="macro">@end(<span class="name">process game</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">20</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">int</span> <span class="fn">get_int</span>(<br/>
<span class="in2"></span><span class="type">std</span>::<span class="type">istream</span> &amp;<span class="keyword">in</span>, <span class="type">int</span> <span class="var">len</span> = <span class="num">4</span><br/>
<span class="in1"></span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">result</span> { <span class="num">0</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">int</span> <span class="var">i</span> { <span class="num">0</span> }; <span class="var">i</span> &lt; <span class="var">len</span>; ++<span class="var">i</span>) {<br/>
<span class="in3"></span><span class="var">result</span> = (<span class="var">result</span> &lt;&lt; <span class="num">8</span>) |<br/>
<span class="in4"></span>(<span class="keyword">in</span>.<span class="fn">get</span>() &amp; <span class="num">0xff</span>);<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">result</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">21</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">out_pos</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="keyword">static</span> <span class="type">const</span> <span class="type">std</span>::<span class="type">string</span> <span class="var">row</span> { <span class="str">"?abcdefgh???????"</span> };<br/>
<span class="in2"></span><span class="keyword">static</span> <span class="type">const</span> <span class="type">std</span>::<span class="type">string</span> <span class="var">col</span> { <span class="str">"?12345678???????"</span> };<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="var">row</span>[<span class="var">pos</span> &gt;&gt; <span class="num">4</span>] &lt;&lt; <span class="var">col</span>[<span class="var">pos</span> &amp; <span class="num">0xf</span>];<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">22</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">bool</span> <span class="var">white_is_playing</span> { <span class="num">true</span> };<br/>
<span class="in1"></span><span class="type">bool</span> <span class="var">board</span>[<span class="num">0x89</span>] = { <span class="num">0</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_pawns</span>[] = { <span class="num">0x12</span>, <span class="num">0x22</span>, <span class="num">0x32</span>, <span class="num">0x42</span>, <span class="num">0x52</span>, <span class="num">0x62</span>, <span class="num">0x72</span>, <span class="num">0x82</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_pawns</span>[] = { <span class="num">0x17</span>, <span class="num">0x27</span>, <span class="num">0x37</span>, <span class="num">0x47</span>, <span class="num">0x57</span>, <span class="num">0x67</span>, <span class="num">0x77</span>, <span class="num">0x87</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_king</span> { <span class="num">0x51</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_king</span> { <span class="num">0x58</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_rooks</span>[] = { <span class="num">0x11</span>, <span class="num">0x81</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_rooks</span>[] = { <span class="num">0x18</span>, <span class="num">0x88</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_queens</span>[] = { <span class="num">0x41</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_queens</span>[] = { <span class="num">0x48</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_bishops</span>[] = { <span class="num">0x31</span>, <span class="num">0x61</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_bishops</span>[] = { <span class="num">0x38</span>, <span class="num">0x68</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">w_knights</span>[] = { <span class="num">0x21</span>, <span class="num">0x71</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">b_knights</span>[] = { <span class="num">0x28</span>, <span class="num">0x78</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span>, <span class="num">0x00</span> };<br/>
<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">23</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="fn">add</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">a</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">b</span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">x</span> { (<span class="var">a</span> &gt;&gt; <span class="num">4</span>) + (<span class="var">b</span> &gt;&gt; <span class="num">4</span>) };<br/>
<span class="in2"></span><span class="keyword">while</span> (<span class="var">x</span> &gt; <span class="num">8</span>) { <span class="var">x</span> -= <span class="num">8</span>; }<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">y</span> { (<span class="var">a</span> &amp; <span class="num">0xf</span>) + (<span class="var">b</span> &amp; <span class="num">0xf</span>) };<br/>
<span class="in2"></span><span class="keyword">while</span> (<span class="var">y</span> &gt; <span class="num">8</span>) { <span class="var">y</span> -= <span class="num">8</span>; }<br/>
<span class="in2"></span><span class="keyword">return</span> (<span class="var">x</span> &lt;&lt; <span class="num">4</span>) | <span class="var">y</span>;<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">move</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">d</span>) {<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span><span class="var">pos</span> = <span class="fn">add</span>(<span class="var">pos</span>, <span class="var">d</span>);<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">capture</span> { <span class="var">board</span>[<span class="var">pos</span>] };<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">capture</span>;<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">move</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">move</span>(<span class="var">pos</span>, (<span class="var">dx</span> &lt;&lt; <span class="num">4</span>) | <span class="var">dy</span>);<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">24</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_king</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no king to move"</span>); }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"K"</span>;<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">25</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">valid</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">x</span> { <span class="var">pos</span> &gt;&gt; <span class="num">4</span> };<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">y</span> { <span class="var">pos</span> &amp; <span class="num">0xf</span> };<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">x</span> &gt;= <span class="num">1</span> &amp;&amp; <span class="var">x</span> &lt;= <span class="num">8</span> &amp;&amp; <span class="var">y</span> &gt;=<span class="num">1</span>  &amp;&amp; <span class="var">y</span> &lt;= <span class="num">8</span>;<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="fn">other_king</span>() {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="var">white_is_playing</span> ? <span class="var">b_king</span> : <span class="var">w_king</span>;<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">in_check_row</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">for</span> (;;) {<br/>
<span class="in3"></span><span class="var">pos</span> = <span class="var">pos</span> + <span class="var">dx</span> * <span class="num">0x10</span> + <span class="var">dy</span> * <span class="num">0x01</span>;<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="fn">valid</span>(<span class="var">pos</span>)) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">pos</span>]) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">return</span> <span class="fn">other_king</span>() == <span class="var">pos</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">26</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">rook_checks</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">in_check_row</span>(<span class="var">pos</span>, +<span class="num">1</span>, <span class="num">0</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, -<span class="num">1</span>, <span class="num">0</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, <span class="num">0</span>, +<span class="num">1</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, <span class="num">0</span>, -<span class="num">1</span>);<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">bishop_checks</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">in_check_row</span>(<span class="var">pos</span>, +<span class="num">1</span>, +<span class="num">1</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, +<span class="num">1</span>, -<span class="num">1</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, -<span class="num">1</span>, +<span class="num">1</span>) ||<br/>
<span class="in3"></span><span class="fn">in_check_row</span>(<span class="var">pos</span>, -<span class="num">1</span>, -<span class="num">1</span>);<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">queen_checks</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">rook_checks</span>(<span class="var">pos</span>) ||<br/>
<span class="in3"></span><span class="fn">bishop_checks</span>(<span class="var">pos</span>);<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">is_rook_move</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">from</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">to</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">orig</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> ((<span class="var">from</span> &gt;&gt; <span class="num">4</span>) == (<span class="var">to</span> &gt;&gt; <span class="num">4</span>)) {<br/>
<span class="in3"></span><span class="keyword">if</span> ((<span class="var">from</span> &amp; <span class="num">0xf</span>) &lt; (<span class="var">to</span> &amp; <span class="num">0xf</span>)) {<br/>
<span class="in4"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> <span class="var">x</span> = <span class="var">from</span> + <span class="num">0x01</span>; <span class="var">x</span> &lt; <span class="var">to</span>; <span class="var">x</span> += <span class="num">0x01</span>) {<br/>
<span class="in5"></span><span class="keyword">if</span> (<span class="var">x</span> == <span class="var">orig</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in5"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">x</span>]) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>} <span class="keyword">else</span> {<br/>
<span class="in4"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> <span class="var">x</span> = <span class="var">to</span> + <span class="num">0x01</span>; <span class="var">x</span> &lt; <span class="var">from</span>; <span class="var">x</span> += <span class="num">0x01</span>) {<br/>
<span class="in5"></span><span class="keyword">if</span> (<span class="var">x</span> == <span class="var">orig</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in5"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">x</span>]) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>}<br/>
<span class="in3"></span><span class="keyword">return</span> <span class="num">true</span>;<br/>
<span class="in2"></span>} <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="var">from</span> &amp; <span class="num">0xf</span>) == (<span class="var">to</span> &amp; <span class="num">0xf</span>)) {<br/>
<span class="in3"></span><span class="keyword">if</span> ((<span class="var">from</span> &gt;&gt; <span class="num">4</span>) &lt; (<span class="var">to</span> &gt;&gt; <span class="num">4</span>)) {<br/>
<span class="in4"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> <span class="var">x</span> = <span class="var">from</span> + <span class="num">0x10</span>; <span class="var">x</span> &lt; <span class="var">to</span>; <span class="var">x</span> += <span class="num">0x10</span>) {<br/>
<span class="in5"></span><span class="keyword">if</span> (<span class="var">x</span> == <span class="var">orig</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in5"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">x</span>]) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>} <span class="keyword">else</span> {<br/>
<span class="in4"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> <span class="var">x</span> = <span class="var">to</span> + <span class="num">0x10</span>; <span class="var">x</span> &lt; <span class="var">from</span>; <span class="var">x</span> += <span class="num">0x10</span>) {<br/>
<span class="in5"></span><span class="keyword">if</span> (<span class="var">x</span> == <span class="var">orig</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in5"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">x</span>]) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>}<br/>
<span class="in3"></span><span class="keyword">return</span> <span class="num">true</span>;<br/>
<span class="in2"></span>} <span class="keyword">else</span> {<br/>
<span class="in3"></span><span class="keyword">return</span> <span class="num">false</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">is_bishop_move</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">from</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">to</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">orig</span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">dx</span> { (<span class="var">to</span> &gt;&gt; <span class="num">4</span>) - (<span class="var">from</span> &gt;&gt; <span class="num">4</span>) };<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">dy</span> { (<span class="var">to</span> &amp; <span class="num">0xf</span>) - (<span class="var">from</span> &amp; <span class="num">0xf</span>) };<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">dx</span> != <span class="var">dy</span> &amp;&amp; <span class="var">dx</span> != -<span class="var">dy</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in2"></span><span class="var">dx</span> = <span class="var">dx</span> &gt; <span class="num">0</span> ? <span class="num">1</span> : -<span class="num">1</span>;<br/>
<span class="in2"></span><span class="var">dy</span> = <span class="var">dy</span> &gt; <span class="num">0</span> ? <span class="num">1</span> : -<span class="num">1</span>;<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">d</span> = <span class="var">dx</span> * <span class="num">0x10</span> + <span class="var">dy</span> * <span class="num">0x01</span>;<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="var">from</span> += <span class="var">d</span>; <span class="var">from</span> != <span class="var">to</span>; <span class="var">from</span> += <span class="var">d</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">from</span> == <span class="var">orig</span>) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="var">board</span>[<span class="var">from</span>]) { <span class="keyword">return</span> <span class="num">false</span>; }<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">is_queen_move</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">from</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">to</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">orig</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">is_rook_move</span>(<span class="var">from</span>, <span class="var">to</span>, <span class="var">orig</span>) || <span class="fn">is_bishop_move</span>(<span class="var">from</span>, <span class="var">to</span>, <span class="var">orig</span>);<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_queen</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no queen to move"</span>); }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"Q"</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">orig</span> { <span class="var">pos</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">capt</span> { <span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>) };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_x</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_y</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> *<span class="var">queens</span> { <span class="var">white_is_playing</span> ? <span class="var">w_queens</span> : <span class="var">b_queens</span> }; *<span class="var">queens</span>; ++<span class="var">queens</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (*<span class="var">queens</span> == <span class="var">pos</span>) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="fn">is_queen_move</span>(*<span class="var">queens</span>, <span class="var">pos</span>, <span class="var">orig</span>)) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">queens</span> &gt;&gt; <span class="num">4</span>) == (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>)) {<br/>
<span class="in4"></span><span class="var">same_x</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">queens</span> &amp; <span class="num">0xf</span>) == (<span class="var">orig</span> &amp; <span class="num">0xf</span>)) {<br/>
<span class="in4"></span><span class="var">same_y</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">same_y</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in4"></span><span class="fn">out_pos</span>(<span class="var">orig</span>);<br/>
<span class="in3"></span>} <span class="keyword">else</span> {<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'a'</span> + (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>) - <span class="num">1</span>);<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in3"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'0'</span> + (<span class="var">orig</span> &amp; <span class="num">0xf</span>));<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">capt</span>) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">queen_checks</span>(<span class="var">pos</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"+"</span>; }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">27</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_rook</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no rook to move"</span>); }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"R"</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span><span class="type">unsigned</span> <span class="type">char</span> <span class="var">orig</span> { <span class="var">pos</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">capt</span> { <span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>) };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_x</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_y</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> *<span class="var">rooks</span> { <span class="var">white_is_playing</span> ? <span class="var">w_rooks</span> : <span class="var">b_rooks</span> }; *<span class="var">rooks</span>; ++<span class="var">rooks</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (*<span class="var">rooks</span> == <span class="var">pos</span>) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="fn">is_rook_move</span>(*<span class="var">rooks</span>, <span class="var">pos</span>, <span class="var">orig</span>)) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">rooks</span> &gt;&gt; <span class="num">4</span>) == (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>)) {<br/>
<span class="in4"></span><span class="var">same_x</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">rooks</span> &amp; <span class="num">0xf</span>) == (<span class="var">orig</span> &amp; <span class="num">0xf</span>)) {<br/>
<span class="in4"></span><span class="var">same_y</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">same_y</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in4"></span><span class="fn">out_pos</span>(<span class="var">orig</span>);<br/>
<span class="in3"></span>} <span class="keyword">else</span> {<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'a'</span> + (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>) - <span class="num">1</span>);<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in3"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'0'</span> + (<span class="var">orig</span> &amp; <span class="num">0xf</span>));<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">capt</span>) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">rook_checks</span>(<span class="var">pos</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"+"</span>; }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">28</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_bishop</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no bishop to move"</span>); }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"B"</span>;<br/>
<span class="in2"></span><span class="type">auto</span> <span class="var">orig</span> { <span class="var">pos</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">capt</span> { <span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>) };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_x</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="type">bool</span> <span class="var">same_y</span> { <span class="num">false</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> *<span class="var">bishops</span> { <span class="var">white_is_playing</span> ? <span class="var">w_bishops</span> : <span class="var">b_bishops</span> }; *<span class="var">bishops</span>; ++<span class="var">bishops</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (*<span class="var">bishops</span> == <span class="var">pos</span>) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> (! <span class="fn">is_bishop_move</span>(*<span class="var">bishops</span>, <span class="var">pos</span>, <span class="var">orig</span>)) { <span class="keyword">continue</span>; }<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">bishops</span> &gt;&gt; <span class="num">4</span>) == (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>)) {<br/>
<span class="in4"></span><span class="var">same_x</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">bishops</span> &amp; <span class="num">0xf</span>) == (<span class="var">orig</span> &amp; <span class="num">0xf</span>)) {<br/>
<span class="in4"></span><span class="var">same_y</span> = <span class="num">true</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">same_y</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in4"></span><span class="fn">out_pos</span>(<span class="var">orig</span>);<br/>
<span class="in3"></span>} <span class="keyword">else</span> {<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'a'</span> + (<span class="var">orig</span> &gt;&gt; <span class="num">4</span>) - <span class="num">1</span>);<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="var">same_x</span>) {<br/>
<span class="in3"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'0'</span> + (<span class="var">orig</span> &amp; <span class="num">0xf</span>));<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">capt</span>) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">bishop_checks</span>(<span class="var">pos</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"+"</span>; }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">29</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">check_chess</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>, <span class="type">unsigned</span> <span class="type">char</span> <span class="var">kp</span>) {<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">valid</span>(<span class="var">pos</span>) &amp;&amp; <span class="var">pos</span> == <span class="var">kp</span>;<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="type">bool</span> <span class="fn">knight_checks</span>(<span class="type">unsigned</span> <span class="type">char</span> <span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="type">auto</span> <span class="var">kp</span> { <span class="fn">other_king</span>() };<br/>
<span class="in2"></span><span class="keyword">return</span> <span class="fn">check_chess</span>(<span class="var">pos</span> + <span class="num">0x10</span> + <span class="num">0x02</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> + <span class="num">0x10</span> - <span class="num">0x02</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> - <span class="num">0x10</span> + <span class="num">0x02</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> - <span class="num">0x10</span> - <span class="num">0x02</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> + <span class="num">0x20</span> + <span class="num">0x01</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> + <span class="num">0x20</span> - <span class="num">0x01</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> - <span class="num">0x20</span> + <span class="num">0x01</span>, <span class="var">kp</span>) ||<br/>
<span class="in3"></span><span class="fn">check_chess</span>(<span class="var">pos</span> - <span class="num">0x20</span> - <span class="num">0x01</span>, <span class="var">kp</span>);<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_knight</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no knight to move"</span>); }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"N"</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="fn">knight_checks</span>(<span class="var">pos</span>)) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"+"</span>; }<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">30</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">move_pawn</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">pos</span>, <span class="type">int</span> <span class="var">dx</span>, <span class="type">int</span> <span class="var">dy</span>) {<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">pos</span>) { <span class="fn">fail</span>(<span class="str">"no pawn to move"</span>); }<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">white_is_playing</span>) { <span class="var">dy</span> = <span class="num">8</span> - <span class="var">dy</span>; <span class="var">dx</span> = (<span class="num">8</span> - <span class="var">dx</span>) % <span class="num">8</span>; }<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">dx</span>) { <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="type">char</span>) (<span class="str">'a'</span> + (<span class="var">pos</span> &gt;&gt; <span class="num">4</span>) - <span class="num">1</span>) &lt;&lt; <span class="str">"x"</span>; }<br/>
<span class="in2"></span><span class="fn">move</span>(<span class="var">pos</span>, <span class="var">dx</span>, <span class="var">dy</span>);<br/>
<span class="in2"></span><span class="fn">out_pos</span>(<span class="var">pos</span>);<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">white_is_playing</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">b_king</span> == <span class="var">pos</span> + <span class="num">0x10</span> + <span class="num">1</span> || <span class="var">b_king</span> == <span class="var">pos</span> - <span class="num">0x10</span> + <span class="num">1</span>) {<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">'+'</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>} <span class="keyword">else</span> {<br/>
<span class="in3"></span><span class="keyword">if</span> (<span class="var">w_king</span> == <span class="var">pos</span> + <span class="num">0x10</span> - <span class="num">1</span> || <span class="var">w_king</span> == <span class="var">pos</span> - <span class="num">0x10</span> - <span class="num">1</span>) {<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">'+'</span>;<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">" "</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span>// <span class="var">TODO</span>: <span class="var">e</span>.<span class="var">p</span>.<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">31</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">kingside_rochade</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">king</span>, <span class="type">unsigned</span> <span class="type">char</span> *<span class="var">rooks</span>) {<br/>
<span class="in2"></span><span class="type">unsigned</span> <span class="type">char</span> *<span class="var">rook</span> { <span class="num">nullptr</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (; *<span class="var">rooks</span>; ++<span class="var">rooks</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">rooks</span> &amp; <span class="num">0xf</span>) == (<span class="var">king</span> &amp; <span class="num">0xf</span>) &amp;&amp; (*<span class="var">rooks</span> &amp; <span class="num">0xf0</span>) &gt; (<span class="var">king</span> &amp; <span class="num">0xf0</span>)) {<br/>
<span class="in4"></span><span class="keyword">if</span> (! <span class="var">rook</span> || (*<span class="var">rook</span> &amp; <span class="num">0xf0</span>) &gt; (*<span class="var">rooks</span> &amp; <span class="num">0xf0</span>)) {<br/>
<span class="in5"></span><span class="var">rook</span> = <span class="var">rooks</span>;<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">rook</span>) {<br/>
<span class="in3"></span><span class="fn">fail</span>(<span class="str">"no kingside rook found"</span>);<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">king</span>] = <span class="var">board</span>[*<span class="var">rook</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span>*<span class="var">rook</span> = <span class="var">king</span> + <span class="num">0x10</span>;<br/>
<span class="in2"></span><span class="var">board</span>[*<span class="var">rook</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span><span class="var">king</span> = *<span class="var">rook</span> + <span class="num">0x10</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">king</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"O-O "</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">32</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">queenside_rochade</span>(<span class="type">unsigned</span> <span class="type">char</span> &amp;<span class="var">king</span>, <span class="type">unsigned</span> <span class="type">char</span> *<span class="var">rooks</span>) {<br/>
<span class="in2"></span><span class="type">unsigned</span> <span class="type">char</span> *<span class="var">rook</span> { <span class="num">nullptr</span> };<br/>
<span class="in2"></span><span class="keyword">for</span> (; *<span class="var">rooks</span>; ++<span class="var">rooks</span>) {<br/>
<span class="in3"></span><span class="keyword">if</span> ((*<span class="var">rooks</span> &amp; <span class="num">0xf</span>) == (<span class="var">king</span> &amp; <span class="num">0xf</span>) &amp;&amp; (*<span class="var">rooks</span> &amp; <span class="num">0xf0</span>) &lt; (<span class="var">king</span> &amp; <span class="num">0xf0</span>)) {<br/>
<span class="in4"></span><span class="keyword">if</span> (! <span class="var">rook</span> || (*<span class="var">rook</span> &amp; <span class="num">0xf0</span>) &lt; (*<span class="var">rooks</span> &amp; <span class="num">0xf0</span>)) {<br/>
<span class="in5"></span><span class="var">rook</span> = <span class="var">rooks</span>;<br/>
<span class="in4"></span>}<br/>
<span class="in3"></span>}<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (! <span class="var">rook</span>) {<br/>
<span class="in3"></span><span class="fn">fail</span>(<span class="str">"no queenside rook found"</span>);<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">king</span>] = <span class="var">board</span>[*<span class="var">rook</span>] = <span class="num">false</span>;<br/>
<span class="in2"></span>*<span class="var">rook</span> = <span class="var">king</span> - <span class="num">0x10</span>;<br/>
<span class="in2"></span><span class="var">board</span>[*<span class="var">rook</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span><span class="var">king</span> = *<span class="var">rook</span> - <span class="num">0x10</span>;<br/>
<span class="in2"></span><span class="var">board</span>[<span class="var">king</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"O-O-O "</span>;<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">33</div>
<code>
<span class="macro">@add(<span class="name">globals</span>)</span><br/>
<span class="in1"></span><span class="type">void</span> <span class="fn">add_board</span>(<span class="type">unsigned</span> <span class="type">char</span> *<span class="var">pos</span>) {<br/>
<span class="in2"></span><span class="keyword">for</span> (; *<span class="var">pos</span>; ++<span class="var">pos</span>) {<br/>
<span class="in3"></span><span class="var">board</span>[*<span class="var">pos</span>] = <span class="num">true</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in1"></span>}<br/>
<span class="macro">@end(<span class="name">globals</span>)</span><br/>
</code></div>
</div>
<div class="page"><div class="slide"><div class="slide-nr">34</div>
<code>
<span class="macro">@def(<span class="name">process moves</span>)</span> {<br/>
<span class="in1"></span><span class="keyword">if</span> (! <span class="var">game_file</span>.<span class="fn">seekg</span>(<span class="fn">get_int</span>(<span class="var">main_entry</span> + <span class="num">1</span>), <span class="type">std</span>::<span class="type">ifstream</span>::<span class="var">beg</span>)) {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="str">"can't move to game at "</span> + <span class="fn">to_str</span>(<span class="fn">get_int</span>(<span class="var">main_entry</span> + <span class="num">1</span>)));<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="type">int</span> <span class="var">len</span> { <span class="fn">get_int</span>(<span class="var">game_file</span>) };<br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">len</span> &amp; <span class="num">0x80000000</span>) {<br/>
<span class="in2"></span><span class="fn">fail</span>(<span class="str">"unknown game data of length "</span> + <span class="fn">to_str</span>(<span class="var">len</span>));<br/>
<span class="in1"></span>}<br/>
<span class="in1"></span><span class="keyword">if</span> (<span class="var">len</span> &amp; <span class="num">0x40000000</span>) {<br/>
<span class="in2"></span><span class="var">len</span> &amp;= <span class="num">0x3fffffff</span>;<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"[SetUp \"1\"]\n"</span>;<br/>
<span class="in2"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"[FEN \"xx\"]\n"</span>;<br/>
<span class="in2"></span><span class="keyword">for</span> (<span class="type">int</span> <span class="var">i</span> { <span class="num">28</span> }; <span class="var">i</span>; --<span class="var">i</span>) { <span class="var">game_file</span>.<span class="fn">get</span>(); }<br/>
<span class="in1"></span>}<br/>
<br/>
<span class="in1"></span><span class="var">board</span>[<span class="var">w_king</span>] = <span class="var">board</span>[<span class="var">b_king</span>] = <span class="num">true</span>;<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">w_pawns</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">b_pawns</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">w_rooks</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">b_rooks</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">w_queens</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">b_queens</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">w_bishops</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">b_bishops</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">w_knights</span>);<br/>
<span class="in1"></span><span class="fn">add_board</span>(<span class="var">b_knights</span>);<br/>
<br/>
<span class="in1"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"\n"</span>;<br/>
<span class="in1"></span><span class="keyword">for</span> (<span class="type">int</span> <span class="var">count</span> { <span class="num">0</span> }; <span class="var">len</span>; ++<span class="var">count</span>, --<span class="var">len</span>, <span class="var">white_is_playing</span> = ! <span class="var">white_is_playing</span>) {<br/>
<span class="in2"></span><span class="type">int</span> <span class="var">ch</span> = (<span class="var">game_file</span>.<span class="fn">get</span>() - <span class="var">count</span>) &amp; <span class="num">0xff</span>;<br/>
<span class="in2"></span>// <span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">'{'</span> &lt;&lt; <span class="type">std</span>::<span class="var">hex</span> &lt;&lt; (<span class="type">int</span>) <span class="var">ch</span> &lt;&lt; <span class="type">std</span>::<span class="var">dec</span> &lt;&lt; <span class="str">"} "</span>;<br/>
<span class="in2"></span><span class="keyword">if</span> (<span class="var">ch</span> == <span class="num">0x0c</span>) {<br/>
<span class="in3"></span>--<span class="var">count</span>; <span class="keyword">continue</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="keyword">if</span> (! (<span class="var">count</span> &amp; <span class="num">1</span>)) {<br/>
<span class="in3"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; (<span class="num">1</span> + (<span class="var">count</span> &gt;&gt; <span class="num">1</span>)) &lt;&lt; <span class="str">". "</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">king</span> { <span class="var">white_is_playing</span> ? <span class="var">w_king</span> : <span class="var">b_king</span> };<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">pawns</span> { <span class="var">white_is_playing</span> ? <span class="var">w_pawns</span> : <span class="var">b_pawns</span> };<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">rooks</span> { <span class="var">white_is_playing</span> ? <span class="var">w_rooks</span> : <span class="var">b_rooks</span> };<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">queens</span> { <span class="var">white_is_playing</span> ? <span class="var">w_queens</span> : <span class="var">b_queens</span> };<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">bishops</span> { <span class="var">white_is_playing</span> ? <span class="var">w_bishops</span> : <span class="var">b_bishops</span> };<br/>
<span class="in2"></span><span class="type">auto</span> &amp;<span class="var">knights</span> { <span class="var">white_is_playing</span> ? <span class="var">w_knights</span> : <span class="var">b_knights</span> };<br/>
<br/>
<span class="in2"></span><span class="keyword">switch</span> (<span class="var">ch</span>) {<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x02</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x05</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">2</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x06</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x07</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x08</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">3</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x09</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">5</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x0b</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">3</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x0e</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x12</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">7</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x13</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">7</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x14</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x15</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">4</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x16</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x17</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x18</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x19</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">7</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x21</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x24</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x26</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x28</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x2c</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x2d</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x2e</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x2f</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x30</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x32</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">6</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x33</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">7</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x34</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">2</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x35</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x36</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">4</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x37</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x39</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x3a</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">6</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x3d</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x3f</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">2</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x41</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x43</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x47</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x48</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x49</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x4a</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x4d</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x4e</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x52</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x53</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x55</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x57</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x58</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x5a</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x5d</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">1</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x5e</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">6</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x5f</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">6</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x61</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x62</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x63</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x64</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x68</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x6b</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x6d</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">3</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x6e</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x6f</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x70</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x71</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x73</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">5</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x75</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">6</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x76</span>:<br/>
<span class="in4"></span><span class="fn">kingside_rochade</span>(<span class="var">king</span>, <span class="var">rooks</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x77</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x78</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x79</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x7b</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">2</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x7c</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x7d</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">5</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x7f</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x84</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">4</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x85</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">2</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x88</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x89</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x8b</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">3</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x8d</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x8e</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x90</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">3</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x93</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x96</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x97</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x98</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">5</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x99</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x9c</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0x9e</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">5</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa1</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">4</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa2</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">5</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa4</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa5</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa6</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa7</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xa9</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xae</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb1</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">7</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb2</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">7</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb4</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb5</span>:<br/>
<span class="in4"></span><span class="fn">queenside_rochade</span>(<span class="var">king</span>, <span class="var">rooks</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb7</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xb8</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xd9</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">4</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xba</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xbb</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">6</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xbc</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">6</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xbd</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xbe</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xbf</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc1</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc2</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">0</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc3</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">5</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc4</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">2</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc5</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">3</span>], <span class="num">0</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xc6</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">2</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xcb</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xd2</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xd4</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xd7</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xd8</span>:<br/>
<span class="in4"></span><span class="fn">move_king</span>(<span class="var">king</span>, <span class="num">1</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xde</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">5</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xda</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">2</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xdd</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">1</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xdf</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">6</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe0</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">2</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe1</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">3</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe2</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe4</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe6</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">7</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xe9</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">6</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xeb</span>:<br/>
<span class="in4"></span><span class="fn">move_queen</span>(<span class="var">queens</span>[<span class="num">0</span>], <span class="num">3</span>, <span class="num">0</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xee</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">4</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf2</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">2</span>, <span class="num">6</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf3</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">6</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf5</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf6</span>:<br/>
<span class="in4"></span><span class="fn">move_bishop</span>(<span class="var">bishops</span>[<span class="num">1</span>], <span class="num">1</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf8</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">0</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xf9</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">3</span>], <span class="num">7</span>, <span class="num">1</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xfa</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">0</span>], <span class="num">7</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xfb</span>:<br/>
<span class="in4"></span><span class="fn">move_rook</span>(<span class="var">rooks</span>[<span class="num">1</span>], <span class="num">0</span>, <span class="num">5</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xfe</span>:<br/>
<span class="in4"></span><span class="fn">move_knight</span>(<span class="var">knights</span>[<span class="num">1</span>], <span class="num">7</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">case</span> <span class="num">0xff</span>:<br/>
<span class="in4"></span><span class="fn">move_pawn</span>(<span class="var">pawns</span>[<span class="num">4</span>], <span class="num">0</span>, <span class="num">2</span>);<br/>
<span class="in4"></span><span class="keyword">break</span>;<br/>
<span class="in3"></span><span class="keyword">default</span>:<br/>
<span class="in4"></span><span class="type">std</span>::<span class="var">cout</span> &lt;&lt; <span class="str">"xx {0x"</span> &lt;&lt; <span class="type">std</span>::<span class="var">hex</span> &lt;&lt; (<span class="type">int</span>) <span class="var">ch</span> &lt;&lt; <span class="type">std</span>::<span class="var">dec</span> &lt;&lt; <span class="str">"} "</span>;<br/>
<span class="in2"></span>}<br/>
<span class="in1"></span>}<br/>
} <span class="macro">@end(<span class="name">process moves</span>)</span><br/>
</code></div>
</div>
</body>
</html>
